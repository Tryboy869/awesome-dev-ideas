name: Weekly Digest

on:
  schedule:
    - cron: '0 12 * * 0'  # Runs every Sunday at 12:00 UTC

jobs:
  generate-digest:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      - name: Install dependencies
        run: npm install

      - name: Generate Weekly Digest
        id: generate_digest
        run: |
          # Here you can add the logic to fetch and compile the weekly digest
          # For example, you might query issues and discussions created in the past week
          echo "Weekly digest content here" > digest.txt
          cat digest.txt

      - name: Post to GitHub Discussions
        uses: peter-evans/discussions@v1
        with:
          title: "Weekly Digest - $(date +'%Y-%m-%d')"
          body: |
            Here is your weekly digest:
            ```
            $(cat digest.txt)
            ```